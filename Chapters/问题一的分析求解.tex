\section{问题一的分析求解}
\subsection{数据处理}
        因为RGB值之间具有很强的自相关性，无法对RGB三个变量建立多元回归方程，考虑到灰度$^{\cite{gr}}$处理是常见的图像处理手段，
        所以先将对应的RGB值转化成灰度。根据灰度计算公式
        $$Gr = 0.2989R + 0.587G + 0.114B$$
        可以得到各物质在不同浓度下的灰度值。
        继续尝试计算RGB的算数平均数和几何平均数，探索浓度是否与RGB的算数平均数和几何平均数有关。
  %      \begin{table}
  %      \begin{tabular}{|c|c|c|c|c|}
  %          \hline
  %          物质 & 浓度 & 灰度 & RGB算术平均数 & RGB几何平均数\\
  %          \hline
  %          \multirow{5}*{组胺} & 0 & 108.18 & 99 & 95.86 \\
  %          & 12.5 & 102.27 & 94.8 & 91.99 \\
  %          &25 & 100.947 & 93.34 & 89.32 \\
  %          &50 & 91.45 & 83.5 & 77.76 \\
  %          &100 & 75.00 & 70.15 & 63.51 \\
  %          \hline
  %          \multirow{5}*{溴酸钾} & 0 & 140.61&138&137.83 \\
  %          &12.5 & 133.35 & 123.33 & 120.11 \\
  %          &25 & 128.89 & 113.5 & 111.34 \\ 
  %          &50 & 126.88 & 110.83 & 103.13 \\
  %          &100 & 122.22 & 95 & 51.30 \\
  %          \hline
  %           \multirow{7}*{工业碱} & 0 & 140.15 & 142 & 141.76 \\
  %          & 7.34 & 139.09 & 141.67 & 141.40 \\
  %          & 8.14 & 140.34 & 142 & 141.81 \\ 
  %          & 8.74 & 129.95 & 137 & 136.23 \\
  %          & 9.19 & 103.53 & 121.33 & 117.32\\
  %          & 10.18 & 62.39 & 89 & 68.21\\
  %          & 11.8 & 41.45 & 63.67 & 37.16\\
  %          \hline
  %            \multirow{6}*{硫酸铝钾} & 0 & 117.64 & 114.61& 114.28 \\
  %          & 0.5 & 101.87 & 105.44 & 98.76\\
  %          & 1 & 100.36 & 104.78 & 96.38\\ 
  %          & 1.5 & 98.89 & 104.95 & 93.91\\
  %          & 2 & 92.04 & 101.17 & 85.49\\
  %          & 5 & 93.45 & 100.83 & 86.75\\
  %          \hline
  %             \multirow{6}*{奶中尿素} & 0 & 134.99 & 131.89 & 131.64 \\
  %          &500 & 135.48 & 131.11 & 130.69 \\
  %          &1000 & 133.48 & 128 & 127.34\\ 
  %          &1500 & 133.14 & 127.11 & 126.39\\
  %          &2000 & 134.14 & 127.56 & 126.64\\
  %          \hline
  %    \end{tabular}
  %\end{table}
   根据数据处理结果，可以看到对于组胺和溴酸钾而言，灰度和其浓度之间有着明显的负相关，所以可以使用一元线性回归方程对其拟合，
   而工业碱，硫酸铝钾和奶中尿素对于灰度的相关性则不强，说明不能单纯使用灰度进行拟合，应该重新使用新的模型进行拟合。
\subsection {组胺浓度与RGBHS之间的关系}

    将所给的数据画出对应的RGB折线图如图~\ref{ZA_RGB_C}所示。

    \quickF{0.6}{ZA_RGB_C.png}{组胺浓度关于RGB的折线图}{ZA_RGB_C}

    根据图~\ref{ZA_RGB_C}，可以看到R，G，B均与组胺浓度$c$有着明显的关系，且随着组胺浓度增加，均有着
    减少的趋势，并且三者的变化范围较大，可以看出较大的差距。

    显然组胺浓度与与RGB有着强烈的负相关性，而RGB属性之间又有着自相关性，进一步计算RGB之间的自相关性系数
      \begin{table}[H]
        \caption{组胺各个属性间的自相关系数}
        \label{组胺各属性相关系数}
        \centering
        \begin{tabular}{|c|c|c|c|c|c|c|}
        \hline
            \diagbox{属性}{属性} & B & G & R & H & S & Gr \\
            \hline
            B & 1    & 0.97 & 0.87  & 0.95 & -0.99 & \null \\
            \hline
            G & 0.97 & 1    & 0.945 & 0.98 & -0.96 & \null \\
            \hline
            R & 0.87 & 0.94 &   1   & 0.89 & -0.84 & \null \\
            \hline
            H & 0.95 & 0.98 & 0.89  &   1  & -0.94 & 0.97  \\
            \hline
            S & -.99 & -0.96& -0.84 & -0.94&   1   & -0.96 \\
            \hline
        \end{tabular}
    \end{table}

    从表~\ref{组胺各属性相关系数}可以看出，B，G，R均有着较大的相关性，所以直接使用三元变量进行拟合
    可能不会得到较好的结果，所以可以使用灰度作为自变量，将一组RGB值转化为灰度，进行一元线性拟合。

    根据所给的两组数据，我们可以看到两组数据的偏差范围不大，所以可以使用两组数据的平均数进行数据处理。
    进一步计算R，G，B，H，S，灰度，RGB算数平均数，RGB几何平均数与组胺浓度的相关系数，得到对应的相关系数为
    \begin{table}[H]
        \centering
        \caption{多个变量与组胺浓度的相关系数}
        \label{ZuAnCov}
        \begin{tabular}{@{}ccccccccc@{}}
        \toprule
        属性 & R       & G      & B       & H       & S       & 灰度     & RGB算数平均数 & RGB几何平均数 \\ \midrule
        大小 & -0.9313 & -0.997 & -0.9724 & -0.9778 & 0.96272 & -0.996 & -0.995   & -0.993   \\ \bottomrule
        \end{tabular}
        \end{table}
         
    由表~\ref{ZuAnCov}可以看到，灰度与浓度的自相关性系数绝对值较接近1，有着强烈的相关性，所以我们
    可以直接使用灰度作为自变量对浓度进行一元的线性回归，这样一方面简化了模型，
    另一方面并没有过多地丢失精度。

    绘制组胺浓度与灰度折线图如图~\ref{ZA_Gr_C}

    \quickF{0.6}{ZA_Gr_C.png}{组胺浓度关于灰度的折线图}{ZA_Gr_C}

    根据所绘制的图~\ref{ZA_Gr_C}，可以看出灰度与组胺浓度近似服从一元线性模型，建立线性回归模型
    $$ y = p_1 \times x + p_2$$
    其中 $p_{1}, p_{2}$为回归系数。利用 Matlab 软件进行求解得到的回归系数估计值及置信区间，检验统计量 $R^2, RMSE $结果如下

    \begin{table}[H]
        \centering
        \caption{一元拟合的参数结果}
        \label{ZuAnLinear}
        \begin{tabular}{@{}ccc@{}}
        \toprule
        参数         & 参数估计值      & 参数置信区间                  \\ \midrule
        $p_1$      & -3.034     & {[}-3.248, -2.82{]}     \\
        $p_2$      & 327.4      & {[}-3.248, -2.82{]}     \\
        \hline
        \multicolumn{3}{c}{$R^2$ = 0.9926 $RMSE$ = 3.404} \\ \bottomrule
        \end{tabular}
        \end{table}

    结果分析： 从表~\ref{ZuAnLinear}可以看出 $R^2$ 近似为1，RMSE的值为3.404，且每个回归系数的置信区间没有包含零点，说明灰度值对浓度影响是显著的，
    所以模型在整体上是合理可用的。说明组胺的浓度可以通过颜色读数来确定，其预测的方程为
    $$y = -3.034x + 327.4 $$
    
    因为H，S与组胺的浓度的相关性系数也较大，也可以尝试用以H，S为自变量。进行二元函数拟合，以求得到更为精确的模型。
    二元函数拟合得到的对应方程为
    $$ z = p_{00} + p_{10} \times x + p_{01} \times y$$
    其中，$x$ 代表 $H$, $y$ 代表 $S$， $p_{00},p_{10},p_{01}$ 代表回归系数，利用 Matlab 软件进行求解得到的回归系数估计值及置信区间，
    检验统计量 $R^2, RMSE $结果如下

    \begin{table}[H]
        \centering
        \caption{二元拟合的参数结果}
        \label{ZuAn2Dim}
        \begin{tabular}{@{}lcc@{}}
        \toprule
        参数       & 参数估计值  & 参数置信区间                       \\ \midrule
        $p_{00}$ & 60.72  & {[}-100.6, 222{]}    \\
        $p_{10}$ & -5.5   & {[}-9.439, -1.561{]} \\
        $p_{01}$ & 0.5614 & {[}-0.1248, 1.248{]} \\
        \hline
        \multicolumn{3}{c}{$R^2$ = 0.914 $RMSE$ =7.147}  \\ \bottomrule
        \end{tabular}
        \end{table}

    结果分析： 从表~\ref{ZuAn2Dim}中可以看出 $R^2$ 近似为1，RMSE的值为7.147，但是注意到$p_{00}$的置信区间和$p_{01}$的置信区间含有零点，
    说明这个这个参数不是很显著，所以这个模型不在这里适用。

\subsection{溴酸钾与RGBHS之间的关系}

    将所给的数据画出对应的RGB折线图，如图~\ref{XSJ_RGB_C}所示。

    \quickF{0.6}{XSJ_RGB_C.png}{组胺浓度关于RGB的折线图}{XSJ_RGB_C}

    从图中可以看到，随着溴酸钾浓度的增加，G，R所对应的两条折线趋势基本趋于平缓， 大概可以判断溴酸钾浓度与G，R这两个维度没有较大的联系，
    进一步计算RGB之间的自相关性系数
    \begin{table}[H]
        \centering
        \caption{各个属性的自相关性系数}
        \label{溴酸钾相关性系数图}
        \begin{tabular}{|c|c|c|c|c|c|c|}
            \hline
            \diagbox{属性}{属性} & B & G & R & H & S & Gr \\
            \hline
            B & 1 & 0.89 & 0.07 & -0.85 & -0.99 & \null \\
            \hline
            G & 0.89 & 1 & 0.46 & -0.87 & -0.89 & \null \\
            \hline
            R & 0.07 & 0.46 & 1 & -0.24 & -0.05 & \null \\
            \hline
            H & -0.85 & -0.87 & -0.24 & 1 & 0.84 & -0.88 \\
            \hline
            S & -0.99 & -0.89 & -0.05 & 0.84 & 1 & -0.97 \\
            \hline
        \end{tabular}
    \end{table}

    根据图~\ref{溴酸钾相关性系数图}可以看到，R与其他变量相关性系数较差，
    但B与G相关性系数较强，所以不能直接使用三元变量进行多元函数拟合，可以
    考虑使用灰度进行一元线性回归拟合。

    对于所给的两组数据，两组数据的极差很小，所以可以直接使用两组数据的平均数进行数据分析，分别计算R，G，B，H，S，灰度，RGB算术平均数，
    RGB几何平均数与溴酸钾浓度的相关系数，得到表~\ref{多变量与溴酸钾浓度}

    \begin{table}[H]
        \centering
        \caption{多个变量与溴酸钾浓度的相关系数}
        \label{多变量与溴酸钾浓度}
        \begin{tabular}{@{}ccccccccc@{}}
        \toprule
        属性 & R     & G     & B     & H    & S    & 灰度    & RGB算数平均数 & RGB几何平均数 \\ \midrule
        大小 & -0.16 & -0.87 & -0.96 & 0.69 & 0.95 & -0.95 & -0.96    & -0.96    \\ \bottomrule
        \end{tabular}
        \end{table}

    由表~\ref{多变量与溴酸钾浓度}中计算的数据，可以看到灰度与浓度的相关性系数绝对值接近1，有着一定的相关性，
    所以我们可以直接使用灰度作为自变量对浓度进行一元的线性回归。这样，一方面简化了模型的复杂度，另一方面并没有过多的丢失精度。

    绘制溴酸钾浓度与灰度折线图如图~\ref{XSJ_Gr_C}

    \quickF{0.6}{XSJ_Gr_C.png}{溴酸钾浓度关于灰度的折线图}{XSJ_Gr_C}

    从图\ref{XSJ_Gr_C}可以看出，灰度与溴酸钾浓度点近似服从线性分布。 以灰度为自变量建立线性回归模型
    $$ y = p_1 \times x + p_2$$
    其中 $p_{1},p_{2}$为回归系数， $x$为灰度。利用 Matlab 软件进行求解得到回归系数估计值及置信区间，
    检验统计量 $R^2, RMSE $结果如表~\ref{溴酸钾一元拟合}所示。

    \begin{table}[H]
        \centering
        \caption{以灰度为自变量一元拟合结果}
        \label{溴酸钾一元拟合}
        \begin{tabular}{@{}ccc@{}}
        \toprule
        参数        & 参数估计值      & 参数置信区间                   \\ \midrule
        $p_1$     & -5.291     & {[}-6.765, -3.817{]}     \\
        $p_2$     & 731.6      & {[}538, 925.2{]}         \\
        \hline
        \multicolumn{3}{c}{$R^2$ = 0.8954 $RMSE$ = 12.78} \\ \bottomrule
        \end{tabular}
        \end{table}
    从表~\ref{溴酸钾一元拟合}可以看到$R^2$近似为1，RMSE 值为12.78，并且两个参数的置信区间并没有包含零点，说明灰度值对溴酸钾浓度影响是显著的，
    因此模型在整体上是合理可用的。说明溴酸钾的浓度可以通过颜色读数来确定，其预测的方程为
    $$ y = -5.291 x + 731.6 $$ 
    其中，$x$ 为灰度值，$y$ 为溴酸钾浓度。

    根据表\ref{多变量与溴酸钾浓度}可以看到RGB的几何平均数与溴酸钾浓度也有较强的关系，也可以尝试采用以RGB的几何平均数为自变量对浓度进行一元线性回归。
    建立一元线性回归方程为
     $$ y = p_1 \times x + p_2$$
    其中 $p_1, p_2$为回归系数。利用 Matlab 软件进行求解得到的回归系数估计值及置信区间，检验统计量 $R^2, RMSE $结果如下

    \begin{table}[H]
        \centering
        \caption{以RGB几何平均数为自变量一元拟合结果}
        \label{RGB拟合}
        \begin{tabular}{@{}ccc@{}}
        \toprule
        参数        & 参数估计值     & 参数置信区间                  \\ \midrule
        $p_1$     & -1.197    & {[}-1.367, -1.026{]}    \\
        $p_2$     & 162.9     & {[}144.3, 181.4{]}      \\
        \hline
        \multicolumn{3}{c}{$R^2$ = 0.9704 $RMSE$ = 6.8} \\ \bottomrule
        \end{tabular}
        \end{table}

    从表~\ref{RGB拟合}可以看到$R^2$ 近似值为1，RMSE值为6.8，并且两个参数的置信区间并没有包含零点，说明RGB的几何平均数对溴酸钾浓度影响是显著的，
    因此模型在整体上是合理可用的。说明溴酸钾的浓度可以通过颜色读数来确定，其预测的方程为
    $$ y = -1.197 x + 162.9 $$
    其中，$x$ 为RGB的几何平均数，$y$ 为溴酸钾浓度。

    同时根据上面的表\ref{溴酸钾相关性系数图}，发现H，S与溴酸钾浓度的相关系数也很大，所以以H，S为自变量进行了多元函数的拟合分析,
    建立二元回归方程 为
    $$ z = p_{00} + p_{10} \times x + p_{01} \times y$$
    其中，$x$ 代表 $H$, $y$ 代表 $S$， $p_{00},p_{10},p_{01}$ 代表回归系数，利用 Matlab 软件进行求解得到的回归系数估计值及置信区间，
    检验统计量 $R^2, RMSE $结果如下

    \begin{table}[H]
        \centering
        \caption{以H,S为自变量二元拟合结果}
        \label{二元拟合结果}
        \begin{tabular}{@{}ccc@{}}
        \toprule
        参数         & 参数估计值     & 参数置信区间                  \\ \midrule
        $p_{00}$     & 155.8     & {[}-29.68, 341.2{]}     \\
        $p_{10}$     & -7.897    & {[}-15.92, 0.1276{]}    \\
        $p_{01}$     & 0.6479    & {[}0.4536, 0.8423{]}    \\
        \hline
        \multicolumn{3}{c}{$R^2$ = 0.9478 $RMSE$ =9.653} \\ \bottomrule
        \end{tabular}
        \end{table}

    结果分析： 从表~\ref{二元拟合结果}可以看出 $R^2$ 近似为1，RMSE的值为9.653，但是注意到$p_{00}$的置信区间和$p_{01}$的置信区间含有零点，
    说明这个这个参数不是很显著，所以这个模型不能在这里使用。

\subsection{工业碱浓度与RGBHS的关系}
    通过分析原始数据，浓度为0的点和浓度为7.34的点所对应的RGBHS值大体相等，但由于浓度为0的点与其他浓度测量值偏离较大，所以可以判断浓度为0的点不是一个有效数据，
    故排除浓度为0的点进行分析。将浓度0点剔除后，绘制对应的RGB折线图如图~\ref{GYJ_RGB_C_no0}所示。

    \quickF{0.6}{GYJ_RGB_C_no0.png}{工业碱浓度去除零点后关于RGB的折线图}{GYJ_RGB_C_no0}

    由图~\ref{GYJ_RGB_C_no0}可以发现，RGB 三条曲线所对应的趋势基本相同相同，变化不大，之间可能有较大的线性相关性。进一步计算他们之间的相关性系数

    \begin{table}[H]
        \centering
        \label{工业碱浓度相关系数图}
        \caption{工业碱各个属性间的自相关系数}
            \begin{tabular}{|c|c|c|c|c|c|c|}
                \hline
                \diagbox{属性}{属性} & B & G & R & H & S & Gr \\
                \hline
                B & 1 & 0.83 & 0.86 & -0.71 & -0.83 & \null \\
                \hline
                G & 0.83 & 1 & 0.87 & -0.97 & -0.99 & \null \\
                \hline
                R & 0.86 & 0.87 & 1 & -0.84 & -0.88 & \null \\
                \hline
                H & -0.71 & -0.97 & -0.84 & 1 & 0.97 & -0.96 \\
                \hline
                S & -0.83 & -0.99 & -0.88 & 0.97 & 1 & -0.99 \\
                \hline
            \end{tabular}
        \end{table}
   
    根据图~\ref{工业碱浓度相关系数图}可以看到 RGB 之间相关性系数较大，
    所以不能直接使用三元变量进行线性回归拟合，可以尝试使用灰度进行一元线性回归拟合。

    绘制工业碱浓度与灰度折线图如图~\ref{GYJ_Gr_C}

    \quickF{0.6}{GYJ_Gr_C.png}{工业碱浓度关于灰度的折线图}{GYJ_Gr_C}

    从图~\ref{GYJ_Gr_C}可以看到，在去除掉浓度为0的点后，工业碱浓度与灰度近似服从一元线性模型，
    所以可以使用灰度进行一元回归分析，建立线性回归模型
    $$ y = p_1 x + p_2 $$
    其中，$p_1, p_2$为回归系数。利用 Matlab 软件进行求解得到的回归系数估计值及置信区间，
    检验统计量$R^2, RMSE $结果如下 

    \begin{table}[H]
        \centering
        \caption{以灰度为自变量一元拟合结果}
        \label{灰度工业碱一元拟合}
        \begin{tabular}{@{}ccc@{}}
        \toprule
        参数       & 参数估计值      & 参数置信区间                     \\ \midrule
        $p_1$    & -0.03599   & {[}-0.05097, -0.02101{]}   \\
        $p_2$    & 12.93      & {[}11.29, 14.58{]}         \\
        \hline
        \multicolumn{3}{c}{$R^2$ = 0.9175 $RMSE$ = 0.5079} \\ \bottomrule
        \end{tabular}
        \end{table}

    结果分析： 从表~\ref{灰度工业碱一元拟合}可以看出 $R^2$ 近似为1，RMSE的值为0.5079，且每个回归系数的置信区间没有包含零点，
    说明灰度值对浓度影响是显著的，所以模型在整体上是合理可用的。说明工业碱溶液的浓度可以通过颜色读数来确定，其预测方程为：
        $$y = -0.03599 x + 12.93 $$
    注意：由于所给的数据量过少，且浓度变化范围主要集中在 $7 \sim 12$之间，所以我们根据灰度来预测时灰度的取值范围也应在 $40 \sim 140$
    之间。
\subsection{硫酸铝钾颜色与浓度的关系}

    将硫酸铝钾的R,G,B,H,S数据按浓度分组,并计算每组平均值，RGB算术平均数和算术平均数。
    取计算所得平均值绘制R,G,B,灰度与浓度的折线图如图~\ref{LSLJ_RGBGr_C}所示。

    \quickF{0.6}{LSLJ_RGBGr_C.png}{硫酸铝钾浓度关于RGB和灰度的折线图}{LSLJ_RGBGr_C}
    
    观察折线图发现,随着硫酸铝钾浓度的增加,R,G,B的值没有明显的变化趋势，只在浓度为0 和不为0间有明显的差异。因此分为保留浓度为0的数据和除去浓度为0的数据两种情况分别分析。若只需要粗略估计浓度
    计算灰度和浓度的相关性。
    \begin{table}[H]
      \centering
      \caption{灰度和硫酸铝钾浓度的相关性}
      \label{硫酸铝钾浓度和灰度}
      \begin{tabular}{@{}ccc@{}}
      \toprule
      浓度 & 包括0     & 不包括0    \\ \midrule
      大小 & -0.6778 & -0.7195 \\ \bottomrule
      \end{tabular}
    \end{table}
    
    观察表~\ref{硫酸铝钾浓度和灰度}发现灰度和浓度的相关性不强。无法建立有关模型。
    
    而由于浓度为0的数据和浓度为0.5ppm及以上的数据之间有较为明显的差异，可以建立一个简略的颜色与浓度的模型。
    $$aver(RGB)>105, \text{if } c<0.5 \text{ ppm} $$
    式中R,G,B的取值范围均在0到255之间，$aver(RGB)$为RGB三个数的数值的算术平均数。
    
    绘制H,S和浓度的折线图如图~\ref{LSLJ_HS_C}所示。

    \quickF{0.6}{LSLJ_HS_C.png}{硫酸铝钾浓度关于HS的折线图}{LSLJ_HS_C}
    
    发现随着浓度的增加，H,S两类数据的变化规律类似，均为在浓度低是快速增加，而浓度高时缓慢增加。
    由此联想到酶促反应$^{\cite{mm}}$$^{\cite{exp}}$中反应速度和底物浓度之间的关系。对于酶促反应的性质，满足的模型有两个：
    
    $Michaelis-Menten$模型（米-曼式模型，也叫快速平衡模型）：
    $$y=\frac{\beta_0x}{\beta_1+x}$$
    
    指数增长模型：$$y=\beta_0(1-e^{-\beta_1x})$$
    
    用指数增长模型对该组数据进行回归分析，其中硫酸铝钾浓度作为自变量，H值和S值作为因变量，得到结果：
    
    拟合结果我觉得不对还没有写  fit中的指数增长模型和酶促反应的不沾边呀
    
    之后再拟合
    
    然后选择$Michaelis-Menten$模型对该组数据进行回归分析。仍旧取硫酸铝钾浓度作为自变量，H值和S值作为因变量，带入模型：
    
    $$y=\frac{\beta_0x}{\beta_1+x}+\beta_3$$
    浓度和H值的拟合结果：
    \begin{table}[H]
      \centering
      \caption{硫酸铝钾浓度和H值回归分析结果}
      \label{硫酸铝钾浓度和H值}
      \begin{tabular}{@{}ccc@{}}
      \toprule
      参数        & 参数估计值      & 参数置信区间                   \\ \midrule
      $\beta_1$     & 27.33     & {[}22.96, 31.7{]}     \\
      $\beta_2$     & 0.07594   & {[}-0.03905, 0.1909{]}    \\
      $\beta_3$     & 74.67     & {[}71.33, 78{]}         \\
      \hline
      \multicolumn{3}{c}{$R^2$ = 0.9941   $RMSE$ = 1.048} \\ \bottomrule
      \end{tabular}
    \end{table}
    
    从表~\ref{硫酸铝钾浓度和H值}中可以看到，R方接近1，RMSE的值为1.048,拟合效果良好，模型可用。
    
    同理，浓度和S值的
    回归结果：
    
    \begin{table}[H]
      \centering
      \caption{硫酸铝钾浓度和S值回归分析结果}
      \label{硫酸铝钾浓度和S值}
      \begin{tabular}{@{}ccc@{}}
      \toprule
      参数        & 参数估计值      & 参数置信区间                   \\ \midrule
      $\beta_1$     & 160.1     & {[}118.6, 201.7{]}     \\
      $\beta_2$     & 0.2812   & {[}-0.02671, 0.5891{]}    \\
      $\beta_3$     & 42.5     & {[}13.38, 71.63{]}         \\
      \hline
      \multicolumn{3}{c}{$R^2$ = 0.9842   $RMSE$ = 9.159} \\ \bottomrule
      \end{tabular}
    \end{table}
    
    从表~\ref{硫酸铝钾浓度和S值}中可以看到，R方接近1，RMSE的值为9.159,相比浓度和H值得回归结果较差。
    选择浓度和H值得模型得到硫酸铝钾颜色和浓度的模型：
    $$y=\frac{27.33x}{0.07594+x}+74.67$$
    \subsection{奶中尿素颜色与浓度的关系}
    计算奶中尿素浓度和个颜色参数的相关性
    
    \begin{table}[H]
      \centering
      \caption{奶中尿素浓度和各颜色参数的相关性}
      \label{奶中尿素浓度相关性}
      \begin{tabular}{@{}ccccccccc@{}}
      \toprule
      属性 & R  & G & B & H & S&灰度 & RGB算术平均数 & RGB几何平均数\\ \midrule
      大小 & -0.4369 & -0.3451  &-0.9603 & 0.6484 &0.9433 & -0.6165 & -0.8551 & -0.8785\\ \bottomrule
      \end{tabular}
    \end{table}
    
    观察表~\ref{奶中尿素浓度相关性}发现B的值和浓度的相关性较强而与灰度的相关性较差，
    以颜色参数B为自变量，奶中尿素浓度为因变量进行一元线性回归
    $$ y = p_1 x + p_2$$
    其中 $p_1，p_2$为回归系数。利用 Matlab 软件进行求解得到的回归系数估计值及置信区间，检验统计量 $R^2, RMSE $结果如下
    
    \begin{table}[H]
      \centering
      \caption{奶中尿素浓度和B值的回归结果}
      \label{奶中尿素和B值回归}
      \begin{tabular}{@{}ccc@{}}
      \toprule
      参数       & 参数估计值      & 参数置信区间                   \\ \midrule
      $p_1$     & -129.7     & {[}-182.1, -77.37{]}     \\
      $p_2$     & 1.549e+04   & {[}9570, 2.141e+04{]}    \\
      \hline
      \multicolumn{3}{c}{$R^2$ = 0.9221   $RMSE$ = 254.5} \\ \bottomrule
      \end{tabular}
    \end{table}
    
    从表~\ref{奶中尿素和B值回归}可以看出 $R^2$ 为0.9221，且每个回归系数的置信区间没有包含零点，说明B值和浓度的回归模型整体可用，
    得到奶中尿素浓度和颜色参数B值之间的模型：
    $$ y = -129.7x + 1.549e{+04}$$
    
    \subsection{数据质量评价}
    建立数据评价模型：
    $$Q=W_1\gamma_1+W_2\gamma_2+W_3\gamma_3+W_4\gamma_4$$
    其中$Q$为数据质量，$W_i (i=1,2,3,4) $为权重,$\gamma_{i} (i=1,2,3,4)$分别为准确度，稳定度，区分度，吻合度

    \subsection{准确度}
    准确度主要从实验数据的数量来考虑，按照概率论有关知识，实验测定次数越多，数据的准确度就越高，
    越有可能接近真实值。设测量次数为n,定义准确度:
    $$\gamma_1=\frac{n_i -\min n}{\max n-\min n}$$
    
    
    再将各个物质得到的结果归一化。得到表~\ref{各物质准确度}
    
    \begin{table}[H]
      \centering
      \caption{各物质准确度}
      \label{各物质准确度}
      \begin{tabular}{@{}ccc@{}}
      \toprule
      物质 & 测量组数  & 准确度 \\ \midrule
      组胺 & 10 & 0.1   \\    \bottomrule
      溴酸钾 & 10 & 0.1  \\    \bottomrule
      工业碱 & 7 & 0     \\      \bottomrule
      硫酸铝钾 & 37 & 1   \\     \bottomrule
      奶中尿素 & 15 & 0.27 \\    \bottomrule
      \end{tabular}
    \end{table}
    
    \subsubsection{稳定度}
    同种物质，在相同浓度下的R,G,B数值应该相对稳定，利用同种物质同一浓度下的变异系数衡量实验数据的稳定度。
    由于工业碱个浓度的数值只有一组，存在偶然性，计算变异系数没有意义。将工业碱归一化的值取中为0.5。

    由稳定度公式
    $$\gamma_2=1-C.v$$
    其中$C.v$表示该物质的变异系数

    又有变异系数公式
    $$C.v = \frac{SD}{Me} \times 100\% = 
    \frac{\sqrt{\frac{1}{N - 1} \sum_{i=1}^{N} (X_{i} - \overline{X})^2 }} {Me} \times 100\%$$

    对变异系数的结果进行归一化处理得到表~\ref{不同物质的稳定度}
    
    \begin{table}[H]
    \centering
    \caption{不同物质的稳定度}
    \label{不同物质的稳定度}
    \begin{tabular}{@{}ccccccccc@{}}
    \toprule
    变异系数 & 浓度   & B    & G    & R     & H     & S     & 归一化  & 稳定度  \\ \midrule
    组胺   & 0    & 3.19\% & 0   \% & 0.59\%  & 3.01 \% & 2.5  \% & 0.1205
     & 0.8794 \\
         & 12.5 & 2.18\% & 0.7 \% & 0   \%  & 0    \% & 1.87\%  &      &      \\
         & 25   & 2.32\% & 0 \%   & 0 \%    & 0 \%    & 2.28 \% &      &      \\
         & 50   & 0  \%  & 0   \% & 0.6 \%  & 0  \%   & 0.92 \% &      &      \\
         & 100  & 3.93 \%& 2.18\% & 0.65\%  & 6.15\%  & 1.24 \% &      &      \\
    溴酸钾  & 0    & 0.55\% & 0   \% & 0.49\%  & 3.14 \% & 2.57\%  & 0    & 1    \\
         & 12.5 & 1.64\% & 0.51\% & 0.49 \% & 0 \%    & 2.72\%  &      &      \\
         & 25   & 1.02 \%& 0.52\% & 0.49\%  & 0  \%   & 0.53 \% &      &      \\
         & 50   & 3.63\% & 0   \% & 0 \%    & 0    \% & 2.87\%  &      &      \\
         & 100  & 0  \%  & 0   \% & 0   \%  & 0 \%    & 0.29 \% &      &      \\
    硫酸铝钾 & 0    & 1.71\% & 0.79 \%& 0.61\%  & 2.89 \% & 6.09 \% & 0.9064 & 0.0935 \\
         & 0.5  & 4.31\% & 3.01 \%& 19.26 \%& 1.15\%  & 16.22\% &      &      \\
         & 1    & 3.76 \%& 2.78 \%& 10.88 \%& 0.52\%  & 6.26 \% &      &      \\
         & 1.5  & 0.27 \%& 1.19 \%& 7.98  \%& 0.51 \% & 3.64 \% &      &      \\
         & 2    & 1.65 \%& 2.6  \%& 6.19  \%& 0.53 \% & 1.72 \% &      &      \\
         & 5    & 1.36 \%& 4.51\% & 20.64 \%& 0.89 \% & 7.45 \% &      &      \\
    奶中尿素 & 0    & 2.98\% & 0.43\% & 0.72 \% & 13.58\% & 14.7 \% & 1    & 0    \\
         & 500  & 2.63\% & 1.84 \%& 1.49 \% & 7.9  \% & 15.79\% &      &      \\
         & 1000 & 2.57 \%& 2.11\% & 2.08 \% & 10.29 \%& 17.68 \%&      &      \\
         & 1500 & 2.65\% & 0.85 \%& 0.42 \% & 2.22 \% & 7.35 \% &      &      \\
         & 2000 & 1.43\% & 1.93 \%& 1.9 \%  & 9.68 \% & 2.62  \%&      &      \\
    工业碱  & 0    & 0    & 0    & 0     & 0     & 0     & 0.5  & 0.5  \\ \bottomrule
    \end{tabular}
    \end{table}
    
    \subsubsection{区分度}
    在对同一种物质不同浓度利用比色法进行实验时，我们希望每组的读书差异相对较大，同种物质不同浓度下的变异系数离散度衡量数据的区分度。
    $$\gamma_3=C.v$$
    
    \begin{table}[H]
    \centering
    \caption{不同物质的区分度}
    \label{my-label}
    \begin{tabular}{@{}lllllll@{}}
    \toprule
    物质   & B     & G     & R     & H     & S     & 归一化         \\ \midrule
    组胺   & 22.97 \%& 17.78\% & 3.59 \% & 23.72 \%& 18.15 \%& 0.306382158 \\
    溴酸钾  & 59.50 \%& 2.42 \% & 1.27 \% & 6.88\%  & 55.82 \%& 0.561411402 \\
    工业碱  & 16.85 \%& 62.41\% & 12.24\% & 15.51\% & 87.12 \%& 1           \\
    硫酸铝钾 & 10.51 \%& 5.58 \% & 41.34\% & 10.11 \%& 34.91\% & 0.410759046 \\
    奶中尿素 & 5.47  \%& 1.62 \% & 1.51 \% & 7.46 \% & 22.48\% & 0           \\ \bottomrule
    \end{tabular}
    \end{table}
    
    
    
    \subsubsection{吻合度}
    吻合度定义为从RGB到HS的吻合度。RGB与HS分别属于两种不同的颜色判定的体系，通过RGB 和HSV 模型之间的转换的公式将每组的数据中的RGB的值
    变换到相应的HS 的值，并与附件中的HS 的值比较，计算误差。定义吻合度为
    $$\gamma_4=(1-\frac{\sum\frac{|S-S^{'}|}{S}}{n})*100\%$$
    分别计算H值和S值的吻合度
    \begin{table}[H]
      \centering
      \caption{不同物质的H值和S值吻合度}
      \label{吻合度表}
      \begin{tabular}{@{}ccc@{}}
      \toprule
      物质 & H值吻合度  & S值吻合度   \\ \midrule
      组胺 & 97.90\% & 99.49\% \\
      溴酸钾 & 98.74\% & 99.34\% \\
      工业碱 & 99.78\% & 98.24\% \\
      硫酸铝钾 & 99.68\% & 99.44\% \\
      奶中尿素 & 98.38\% & 99.15\% \\ \bottomrule
      \end{tabular}
    \end{table}
    
    观察表~\ref{吻合度表}发现，各组物质的吻合度都接近百分之百，实验数据的记录比较准确，
    可以简化数据评价模型为
    $$Q=W_1+\gamma_1+W_2+\gamma_2+W_3+\gamma_3$$
    
    根据之前所计算的准确度，稳定度，区分度的个数值，设置权重均为$\frac{1}{3}$， 得到数据质量评价表\ref{数据质量表}
    
    \begin{table}[H]
      \centering
      \caption{不同物质的数据质量评价表}
      \label{数据质量表}
      \begin{tabular}{@{}ccc@{}}
      \toprule
      物质 & 数据质量  \\ \midrule
      组胺 & 0.4236  \\
      溴酸钾 & 0.5538  \\
      工业碱 & 0.4977  \\
      硫酸铝钾 & 0.5014 \\
      奶中尿素 & 0.0888 \\ \bottomrule
      \end{tabular}
    \end{table}
    
    
    观察表~\ref{数据质量表}，发现奶中尿素的数据质量
    
    
    这里应该巴拉巴拉说一堆啊
    